;window.Modernizr=function(a,b,c){function y(a){i.cssText=a}function z(a,b){return y(l.join(a+";")+(b||""))}function A(a,b){return typeof a===b}function B(a,b){return!!~(""+a).indexOf(b)}function C(a,b){for(var d in a){var e=a[d];if(!B(e,"-")&&i[e]!==c)return b=="pfx"?e:!0}return!1}function D(a,b,d){for(var e in a){var f=b[a[e]];if(f!==c)return d===!1?a[e]:A(f,"function")?f.bind(d||b):f}return!1}function E(a,b,c){var d=a.charAt(0).toUpperCase()+a.slice(1),e=(a+" "+n.join(d+" ")+d).split(" ");return A(b,"string")||A(b,"undefined")?C(e,b):(e=(a+" "+o.join(d+" ")+d).split(" "),D(e,b,c))}var d="2.8.3",e={},f=b.documentElement,g="modernizr",h=b.createElement(g),i=h.style,j,k={}.toString,l=" -webkit- -moz- -o- -ms- ".split(" "),m="Webkit Moz O ms",n=m.split(" "),o=m.toLowerCase().split(" "),p={},q={},r={},s=[],t=s.slice,u,v=function(){function d(d,e){e=e||b.createElement(a[d]||"div"),d="on"+d;var f=d in e;return f||(e.setAttribute||(e=b.createElement("div")),e.setAttribute&&e.removeAttribute&&(e.setAttribute(d,""),f=A(e[d],"function"),A(e[d],"undefined")||(e[d]=c),e.removeAttribute(d))),e=null,f}var a={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return d}(),w={}.hasOwnProperty,x;!A(w,"undefined")&&!A(w.call,"undefined")?x=function(a,b){return w.call(a,b)}:x=function(a,b){return b in a&&A(a.constructor.prototype[b],"undefined")},Function.prototype.bind||(Function.prototype.bind=function(b){var c=this;if(typeof c!="function")throw new TypeError;var d=t.call(arguments,1),e=function(){if(this instanceof e){var a=function(){};a.prototype=c.prototype;var f=new a,g=c.apply(f,d.concat(t.call(arguments)));return Object(g)===g?g:f}return c.apply(b,d.concat(t.call(arguments)))};return e}),p.video=function(){var a=b.createElement("video"),c=!1;try{if(c=!!a.canPlayType)c=new Boolean(c),c.ogg=a.canPlayType('video/ogg; codecs="theora"').replace(/^no$/,""),c.h264=a.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/,""),c.webm=a.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/,"")}catch(d){}return c};for(var F in p)x(p,F)&&(u=F.toLowerCase(),e[u]=p[F](),s.push((e[u]?"":"no-")+u));return e.addTest=function(a,b){if(typeof a=="object")for(var d in a)x(a,d)&&e.addTest(d,a[d]);else{a=a.toLowerCase();if(e[a]!==c)return e;b=typeof b=="function"?b():b,typeof enableClasses!="undefined"&&enableClasses&&(f.className+=" "+(b?"":"no-")+a),e[a]=b}return e},y(""),h=j=null,e._version=d,e._prefixes=l,e._domPrefixes=o,e._cssomPrefixes=n,e.hasEvent=v,e.testProp=function(a){return C([a])},e.testAllProps=E,e.prefixed=function(a,b,c){return b?E(a,b,c):E(a,"pfx")},e}(this,this.document),Modernizr.addTest("cssfilters",function(){var a=document.createElement("div");return a.style.cssText=Modernizr._prefixes.join("filter:blur(2px); "),!!a.style.length&&(document.documentMode===undefined||document.documentMode>9)}),Modernizr.addTest("svgfilters",function(){var a=!1;try{a=typeof SVGFEColorMatrixElement!==undefined&&SVGFEColorMatrixElement.SVG_FECOLORMATRIX_TYPE_SATURATE==2}catch(b){}return a});(function(){var advanceShow,alphaWrap,animationEndEventName,audioDuration,audioPlayer,betaWrap,chaptersList,contentElements,currentIndex,currentItem,formatTime,getItemIndexByTime,getYoutubeIframe,hiddenSet,initAudioPlayer,initMap,nextItem,playToggle,progress,seekVideoByIndex,seekVideoByRatio,setMedia,setProgress,showItemByTime,timeEl,toggleChapterList,transitionEndEventName,transitionEndEventNames,visibleSet;alphaWrap=document.querySelector('.alpha');audioPlayer=SC.Widget(document.querySelector('.audio-player iframe'));audioDuration=null;betaWrap=document.querySelector('.beta');chaptersList=document.querySelector('.list');contentElements={"alpha":{wrap:alphaWrap,bg:alphaWrap.querySelector('.bg'),image:alphaWrap.querySelector('.image'),map:alphaWrap.querySelector('.map'),video:alphaWrap.querySelector('.video'),videoFrame:alphaWrap.querySelector('.video-frame')},"beta":{wrap:betaWrap,bg:betaWrap.querySelector('.bg'),image:betaWrap.querySelector('.image'),map:betaWrap.querySelector('.map'),video:betaWrap.querySelector('.video'),videoFrame:betaWrap.querySelector('.video-frame')}};currentIndex=0;currentItem=content[currentIndex];hiddenSet=contentElements["beta"];nextItem=content[currentIndex+1];playToggle=document.querySelector('.play-toggle');progress=document.querySelector('.progress');timeEl=document.querySelector('.time');visibleSet=contentElements["alpha"];if(Modernizr.testProp('webkitAnimation')){animationEndEventName='webkitAnimationEnd';}else if(Modernizr.testProp('mozAnimation')){animationEndEventName='mozAnimationEnd';}else{animationEndEventName='animationEnd';}
transitionEndEventNames={'WebkitTransition':'webkitTransitionEnd','MozTransition':'transitionend','OTransition':'oTransitionEnd','msTransition':'MSTransitionEnd','transition':'transitionend'};transitionEndEventName=transitionEndEventNames[Modernizr.prefixed('transition')];advanceShow=function(){var nextIndex;currentIndex+=1;currentItem=content[currentIndex];nextIndex=currentIndex+1;if(nextIndex<content.length){nextItem=content[nextIndex];}
if(alphaWrap.classList.contains('is-active')){visibleSet=contentElements["beta"];hiddenSet=contentElements["alpha"];}else{visibleSet=contentElements["alpha"];hiddenSet=contentElements["beta"];}
visibleSet["wrap"].classList.add('is-active');hiddenSet["wrap"].classList.add('is-exiting');hiddenSet["wrap"].classList.remove('is-active');return $(visibleSet["wrap"]).on(transitionEndEventName,function(){$(visibleSet["wrap"]).off(transitionEndEventName);hiddenSet["wrap"].classList.remove('is-exiting');if(nextItem){return setMedia(hiddenSet,nextItem);}});};initAudioPlayer=function(){audioPlayer.bind(SC.Widget.Events.PLAY_PROGRESS,function(data){setProgress(data.relativePosition,data.currentPosition);if(nextItem&&data.currentPosition>=nextItem['start']){nextItem=null;return advanceShow();}});audioPlayer.bind(SC.Widget.Events.SEEK,function(data){setProgress(data.relativePosition,data.currentPosition);return showItemByTime(data.currentPosition);});audioPlayer.bind(SC.Widget.Events.PAUSE,function(){document.body.classList.remove('playing');document.body.classList.add('paused');return playToggle.innerHTML='play';});return audioPlayer.bind(SC.Widget.Events.PLAY,function(){document.body.classList.add('playing');document.body.classList.remove('paused');return playToggle.innerHTML='pause';});};initMap=function(set,item){var latLong,myPano,panoramaOptions;latLong=new google.maps.LatLng(item['lat'],item['long']);panoramaOptions={position:latLong,pov:{heading:item['heading'],pitch:item['pitch']},zoom:1};myPano=new google.maps.StreetViewPanorama(set["map"],panoramaOptions);return myPano.setVisible(true);};formatTime=function(ms){var minutes,seconds,timeString,totalSeconds;totalSeconds=ms/1000;totalSeconds%=3600;minutes=Math.floor(totalSeconds/60);seconds=Math.floor(totalSeconds%60);if(minutes<10){minutes="0"+minutes;}
if(seconds<10){seconds="0"+seconds;}
timeString='';timeString+=minutes+':';timeString+=seconds;return timeString;};getItemIndexByTime=function(time){var index,item,_i,_len;currentIndex=0;for(index=_i=0,_len=content.length;_i<_len;index=++_i){item=content[index];if(time>=item['start']){currentIndex=index;}}
return currentIndex;};getYoutubeIframe=function(id){return"<iframe width='420' height='315' src='//www.youtube.com/embed/"+id+"?rel=0&loop=1&autoplay=1&controls=0&playsinline=1&modestbranding=1&playlist="+id+"' frameborder='0'></iframe>";};showItemByTime=function(time){var nextIndex;currentIndex=getItemIndexByTime(time);currentItem=content[currentIndex];nextIndex=currentIndex+1;setMedia(visibleSet,currentItem);if(nextIndex<content.length){nextItem=content[nextIndex];return setMedia(hiddenSet,nextItem);}};setMedia=function(set,item){var currentType,hasMap,removedType,type,_i,_len,_ref;hasMap=false;set["bg"].src=item['image'];if(item['video']){set["videoFrame"].innerHTML=getYoutubeIframe(item['youtube']);set["video"].classList.remove('is-hidden');set["image"].classList.add('is-hidden');set["wrap"].style['background']=item['color'];currentType='video';}else if(item['image']){if(item['lat']){hasMap=true;initMap(set,item);set["map"].classList.remove('is-hidden');set["image"].classList.add('is-hidden');currentType='map';}else{set["image"].src=item['image'];set["image"].classList.remove('is-hidden');currentType='image';}
set["videoFrame"].innerHTML='';set["video"].classList.add('is-hidden');set["wrap"].style['background']='';}
if(!hasMap){set["map"].classList.add('is-hidden');set["map"].innerHTML='';}
removedType=currentType==='video'?'image':'video';_ref=["image","map","video"];for(_i=0,_len=_ref.length;_i<_len;_i++){type=_ref[_i];if(type!==currentType){set["wrap"].classList.remove("is-"+type);}}
return set["wrap"].classList.add("is-"+currentType);};setProgress=function(pos,ms){progress.style.width=""+(pos*100)+"%";return timeEl.innerHTML=formatTime(ms);};seekVideoByIndex=function(index){var time;time=content[index]["start"];audioPlayer.play();return audioPlayer.seekTo(time);};seekVideoByRatio=function(pos){if(!audioDuration){return audioPlayer.getDuration(function(data){audioDuration=data;return seekVideoByRatio(pos);});}else{return audioPlayer.seekTo(audioDuration*pos);}};toggleChapterList=function(){chaptersList.classList.toggle('is-hidden');document.body.classList.toggle('showing-chapters');if(chaptersList.classList.contains('is-hidden')){return $(window).off('keyup.chapters');}else{return $(window).on('keyup.chapters',function(e){if(e.keyCode===27){return toggleChapterList();}});}};$(function(){setMedia(visibleSet,content[0]);setMedia(hiddenSet,content[1]);initAudioPlayer();$('.intro').on('click',function(){document.body.classList.remove('not-played');return audioPlayer.play();});$(playToggle).on('click',function(){return audioPlayer.toggle();});$('.chapters-toggle').on('click',function(){return toggleChapterList();});$('.chapter-link').on('click',function(){var index;index=this.getAttribute('data-index');toggleChapterList();document.body.classList.remove('not-played');return seekVideoByIndex(index);});if(!(Modernizr['cssfilters']||Modernizr['svgfilters'])){document.body.classList.add('no-blur');}
$(window).on('keyup.global',function(e){if(e.keyCode===32){document.body.classList.remove('not-played');return audioPlayer.toggle();}});return $('.seek-bar').on('click',function(ev){var $div,offset,x;$div=$(ev.target);offset=$div.offset();x=ev.clientX-offset.left;if(x){return seekVideoByRatio(x/this.offsetWidth);}});});}).call(this);